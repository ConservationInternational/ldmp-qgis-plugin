sudo: required
addons:
    hosts:
    - boundless-test
services:
    - docker
env:
  global:
    - PLUGIN_NAME=LDMP
  matrix:
    - QGIS_VERSION_TAG=release PYTHON_EXECUTABLE=python PIP_EXECUTABLE=pip
    - QGIS_VERSION_TAG=master_2 PYTHON_EXECUTABLE=python PIP_EXECUTABLE=pip
    - QGIS_VERSION_TAG=master PYTHON_EXECUTABLE=python3 PIP_EXECUTABLE=pip3
matrix:
    allow_failures:
    - env: QGIS_VERSION_TAG=master PYTHON_EXECUTABLE=python3 PIP_EXECUTABLE=pip3
    - env: QGIS_VERSION_TAG=release PYTHON_EXECUTABLE=python PIP_EXECUTABLE=pip
before_install:
    - docker-compose up -d
    - docker-compose ps
    - sleep 10
    - docker-compose exec qgis-testing-environment sh -c "qgis_setup.sh ${PLUGIN_NAME}"
    - docker-compose exec qgis-testing-environment sh -c "pip install paver"
    - docker-compose exec qgis-testing-environment sh -c "pip install boto3"
script:
    - docker-compose exec qgis-testing-environment sh -c "cd /tests_directory && paver setup && paver package --tests"
